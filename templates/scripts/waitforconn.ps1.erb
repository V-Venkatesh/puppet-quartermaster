$conn = @(); 
while ($conn.Count -lt 1) {
    Write-Output 'Waiting for connection...'; 
    Start-Sleep -Seconds 1; 
    $conn = @(Get-WmiObject Win32_NetworkAdapter | 
        Where-Object {$_.NetConnectionStatus -eq 2} | 
        ForEach-Object {$_.GetRelated('Win32_NetworkAdapterConfiguration')} | 
        Where-Object {$_.IPAddress -ne $null -and $_.DefaultIPGateway -ne $null -and $_.DNSServerSearchOrder -ne $null});
    }; 
Write-Output $conn; 
Start-Sleep -Seconds 3;
